{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/components/ui/button.tsx"],"sourcesContent":["import { forwardRef } from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport type { ComponentPropsWithoutRef, ElementRef } from \"react\";\nimport { twMerge } from \"tailwind-merge\";\n\nconst baseStyles =\n  \"inline-flex items-center justify-center rounded-[12px] border border-transparent bg-[#DC2626] px-5 py-2.5 text-sm font-semibold text-white shadow-[0_2px_8px_rgba(220,38,38,0.2)] transition-all duration-200 ease-out hover:bg-[#B91C1C] hover:shadow-[0_4px_12px_rgba(220,38,38,0.25)] active:scale-[0.98] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[#DC2626]/30 disabled:pointer-events-none disabled:opacity-50 disabled:cursor-not-allowed\";\n\ntype ButtonProps = ComponentPropsWithoutRef<\"button\"> & {\n  asChild?: boolean;\n};\n\nexport const Button = forwardRef<ElementRef<\"button\">, ButtonProps>(function Button(\n  { className, asChild = false, ...props },\n  ref,\n) {\n  const Component = asChild ? Slot : \"button\";\n\n  return (\n    <Component\n      ref={ref}\n      className={twMerge(baseStyles, className)}\n      {...props}\n    />\n  );\n});\n\n"],"names":["forwardRef","Slot","ComponentPropsWithoutRef","ElementRef","twMerge","baseStyles","ButtonProps","asChild","Button","t0","ref","$","_c","$i","Symbol","for","className","props","t1","undefined","Component","t2","t3"],"mappings":";;;;;;AAAA,SAASA,UAAU,QAAQ,OAAO;AAClC,SAASC,IAAI,QAAQ,sBAAsB;AAE3C,SAASG,OAAO,QAAQ,gBAAgB;;;;;;AAExC,MAAMC,UAAU,GACd,2eAA2e;AAMte,MAAMG,MAAM,qBAAGR,sWAAU,CAACG,MAAmC,IAAzB,CAAC,IAAwBK,IAAhB,CAAC,EAAeC,AAAbH,EAAa,EAAAI,GAAA,IAAF,CAAC;IAAC,MAAAC,CAAA,OAAAC,2WAAA,EAAA;IAAA,IAAAD,CAAA,CAAA,EAAA,KAAA,oEAAA;QAAA,IAAA,IAAAE,EAAA,GAAA,GAAAA,EAAA,GAAA,IAAAA,EAAA,IAAA,EAAA;YAAAF,CAAA,CAAAE,EAAA,CAAA,GAAAC,MAAA,CAAAC,GAAA,CAAA;QAAA;QAAAJ,CAAA,CAAA,EAAA,GAAA;IAAA;IAAA,IAAAK,SAAA;IAAA,IAAAC,KAAA;IAAA,IAAAC,EAAA;IAAA,IAAAP,CAAA,CAAA,EAAA,KAAAF,EAAA,EAAA;QAClE,CAAA,EAAAO,SAAA,EAAAT,OAAA,EAAAW,EAAA,EAAA,GAAAD,OAAA,GAAAR,EAAwC;QAAAE,CAAA,CAAA,EAAA,GAAAF,EAAA;QAAAE,CAAA,CAAA,EAAA,GAAAK,SAAA;QAAAL,CAAA,CAAA,EAAA,GAAAM,KAAA;QAAAN,CAAA,CAAA,EAAA,GAAAO,EAAA;IAAA,OAAA;QAAAF,SAAA,GAAAL,CAAA,CAAA,EAAA;QAAAM,KAAA,GAAAN,CAAA,CAAA,EAAA;QAAAO,EAAA,GAAAP,CAAA,CAAA,EAAA;IAAA;IAA3B,MAAAJ,OAAA,GAAAW,EAAe,KAAfC,SAAe,GAAf,KAAe,GAAfD,EAAe;IAG5B,MAAAE,SAAA,GAAkBb,OAAO,GAAPN,+SAAyB,GAAzB,QAAyB;IAAC,IAAAoB,EAAA;IAAA,IAAAV,CAAA,CAAA,EAAA,KAAAK,SAAA,EAAA;QAK7BK,EAAA,OAAAjB,uOAAO,EAACC,UAAU,EAAEW,SAAS,CAAC;QAAAL,CAAA,CAAA,EAAA,GAAAK,SAAA;QAAAL,CAAA,CAAA,EAAA,GAAAU,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAAV,CAAA,CAAA,EAAA;IAAA;IAAA,IAAAW,EAAA;IAAA,IAAAX,CAAA,CAAA,EAAA,KAAAS,SAAA,IAAAT,CAAA,CAAA,EAAA,KAAAM,KAAA,IAAAN,CAAA,CAAA,EAAA,KAAAD,GAAA,IAAAC,CAAA,CAAA,GAAA,KAAAU,EAAA,EAAA;QAF3CC,EAAA,iBAAA,wXAAC,SAAS;YACHZ,GAAG,CAAHA,CAAAA,GAAE,CAAC;YACG,SAA8B,CAA9B,CAAAW,EAA6B,CAAC;YAAA,GACrCJ,KAAK,IACT;;;;;;QAAAN,CAAA,CAAA,EAAA,GAAAS,SAAA;QAAAT,CAAA,CAAA,EAAA,GAAAM,KAAA;QAAAN,CAAA,CAAA,EAAA,GAAAD,GAAA;QAAAC,CAAA,CAAA,GAAA,GAAAU,EAAA;QAAAV,CAAA,CAAA,GAAA,GAAAW,EAAA;IAAA,OAAA;QAAAA,EAAA,GAAAX,CAAA,CAAA,GAAA;IAAA;IAAA,OAJFW,EAIE;AAAA,CAEL,CAAC","ignoreList":[],"debugId":null}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/components/autocomplete-input.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Check, ChevronDown } from \"lucide-react\";\n\ninterface AutocompleteInputProps {\n  value: string;\n  onChange: (value: string) => void;\n  onSelect?: (value: string) => void;\n  placeholder?: string;\n  className?: string;\n  fetchSuggestions: (query: string) => Promise<string[]>;\n  minChars?: number;\n  showOnFocus?: boolean; // Vis forslag når feltet får fokus, selv hvis der ikke er skrevet noget\n}\n\nexport function AutocompleteInput({\n  value,\n  onChange,\n  onSelect,\n  placeholder,\n  className = \"\",\n  fetchSuggestions,\n  minChars = 2,\n  showOnFocus = false,\n}: AutocompleteInputProps) {\n  const [suggestions, setSuggestions] = useState<string[]>([]);\n  const [isOpen, setIsOpen] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const timeoutRef = useRef<NodeJS.Timeout | undefined>(undefined);\n\n  const loadSuggestions = useCallback(\n    async (query: string = \"\", forceLoad = false) => {\n      // Hvis showOnFocus er true og query er tom, load alligevel\n      if (!forceLoad && query.length < minChars) {\n        setSuggestions([]);\n        setIsOpen(false);\n        return;\n      }\n\n      setIsLoading(true);\n      try {\n        const results = await fetchSuggestions(query || \"\");\n        setSuggestions(results);\n        setIsOpen(results.length > 0);\n        setSelectedIndex(-1);\n      } catch (error) {\n        console.error(\"Fejl ved hentning af forslag:\", error);\n        setSuggestions([]);\n        setIsOpen(false);\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [fetchSuggestions, minChars],\n  );\n\n  useEffect(() => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    timeoutRef.current = setTimeout(() => {\n      void loadSuggestions(value);\n    }, 300); // Debounce 300ms\n\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, [value, loadSuggestions]);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        containerRef.current &&\n        !containerRef.current.contains(event.target as Node)\n      ) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n  }, []);\n\n  const handleSelect = (suggestion: string) => {\n    onChange(suggestion);\n    if (onSelect) {\n      onSelect(suggestion);\n    }\n    setIsOpen(false);\n    inputRef.current?.blur();\n  };\n\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (!isOpen || suggestions.length === 0) return;\n\n    switch (event.key) {\n      case \"ArrowDown\":\n        event.preventDefault();\n        setSelectedIndex((prev) =>\n          prev < suggestions.length - 1 ? prev + 1 : prev,\n        );\n        break;\n      case \"ArrowUp\":\n        event.preventDefault();\n        setSelectedIndex((prev) => (prev > 0 ? prev - 1 : -1));\n        break;\n      case \"Enter\":\n        event.preventDefault();\n        if (selectedIndex >= 0 && selectedIndex < suggestions.length) {\n          handleSelect(suggestions[selectedIndex]!);\n        }\n        break;\n      case \"Escape\":\n        setIsOpen(false);\n        setSelectedIndex(-1);\n        break;\n    }\n  };\n\n  return (\n    <div \n      ref={containerRef} \n      className=\"relative\"\n      onClick={(e) => e.stopPropagation()}\n      onFocus={(e) => e.stopPropagation()}\n    >\n      <div className=\"relative\">\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={value}\n          onChange={(e) => {\n            e.stopPropagation();\n            onChange(e.target.value);\n          }}\n          onFocus={async (e) => {\n            // Stop event propagation for at forhindre at andre felter åbner\n            e.stopPropagation();\n            if (showOnFocus) {\n              // Hvis showOnFocus er true, load forslag når feltet får fokus\n              await loadSuggestions(\"\", true);\n            } else if (suggestions.length > 0) {\n              setIsOpen(true);\n            }\n          }}\n          onClick={(e) => {\n            // Stop event propagation\n            e.stopPropagation();\n          }}\n          onKeyDown={handleKeyDown}\n          placeholder={placeholder}\n          className={className}\n        />\n        {isLoading && (\n          <div className=\"absolute right-3 top-1/2 -translate-y-1/2\">\n            <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-[#DC2626] border-t-transparent\" />\n          </div>\n        )}\n        {!isLoading && isOpen && suggestions.length > 0 && (\n          <ChevronDown className=\"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-[#6B7280]\" />\n        )}\n      </div>\n\n      {isOpen && suggestions.length > 0 && (\n        <div \n          className=\"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-xl border border-[#E5E7EB] bg-white shadow-lg\"\n          onClick={(e) => e.stopPropagation()}\n          onMouseDown={(e) => e.stopPropagation()}\n        >\n          {suggestions.map((suggestion, index) => (\n            <button\n              key={suggestion}\n              type=\"button\"\n              onClick={(e) => {\n                e.stopPropagation();\n                handleSelect(suggestion);\n              }}\n              onMouseDown={(e) => e.stopPropagation()}\n              className={`w-full px-4 py-2.5 text-left text-sm transition ${\n                index === selectedIndex\n                  ? \"bg-[#DC2626]/10 text-[#DC2626]\"\n                  : \"text-[#1f2937] hover:bg-[#F9FAFB]\"\n              }`}\n            >\n              <div className=\"flex items-center justify-between\">\n                <span>{suggestion}</span>\n                {value.toLowerCase() === suggestion.toLowerCase() && (\n                  <Check className=\"h-4 w-4 text-[#DC2626]\" />\n                )}\n              </div>\n            </button>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\n"],"names":["useCallback","useEffect","useRef","useState","Check","ChevronDown","AutocompleteInputProps","value","onChange","onSelect","placeholder","className","fetchSuggestions","query","Promise","minChars","showOnFocus","AutocompleteInput","suggestions","setSuggestions","isOpen","setIsOpen","isLoading","setIsLoading","selectedIndex","setSelectedIndex","inputRef","HTMLInputElement","containerRef","HTMLDivElement","timeoutRef","NodeJS","Timeout","undefined","loadSuggestions","forceLoad","length","results","error","console","current","clearTimeout","setTimeout","handleClickOutside","event","MouseEvent","contains","target","Node","document","addEventListener","removeEventListener","handleSelect","suggestion","blur","handleKeyDown","React","KeyboardEvent","key","preventDefault","prev","e","stopPropagation","map","index","toLowerCase"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 328, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/app/wine-details/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { revalidatePath } from \"next/cache\";\nimport type { SupabaseClient } from \"@supabase/supabase-js\";\nimport { z } from \"zod\";\nimport { nanoid } from \"nanoid\";\nimport { createSupabaseServiceClient } from \"@/lib/supabase/server\";\nimport { Buffer } from \"node:buffer\";\nimport type { Database } from \"@/lib/supabase/types\";\nimport { createOpenAIClient } from \"@/lib/ai\";\n\nconst wineFormSchema = z.object({\n  producer: z.string().min(1, \"Producent skal udfyldes\"),\n  appellation: z\n    .string()\n    .max(200, \"Appellation er for lang\")\n    .optional()\n    .nullable(),\n  cuvee: z\n    .string()\n    .max(200, \"Cuvée-navn er for langt\")\n    .optional()\n    .nullable(),\n  vintage: z\n    .string()\n    .max(12, \"Årgang er for lang\")\n    .optional()\n    .nullable(),\n  type: z.enum([\"rød\", \"hvid\", \"rosé\", \"mousserende\"]),\n  country: z.string().optional().nullable(),\n  wine_district: z.string().optional().nullable(),\n  grapes: z.string().optional().nullable(),\n  alcohol: z.string().optional().nullable(),\n  vineyard: z.string().optional().nullable(),\n  consumed_date: z.string().optional(),\n  balance: z.coerce.number().int().refine((val) => [80, 85, 90, 95, 100].includes(val), {\n    message: \"Balance skal være 80, 85, 90, 95 eller 100 point\"\n  }).optional().nullable(),\n  length: z.coerce.number().int().refine((val) => [80, 85, 90, 95, 100].includes(val), {\n    message: \"Længde skal være 80, 85, 90, 95 eller 100 point\"\n  }).optional().nullable(),\n  intensity: z.coerce.number().int().refine((val) => [80, 85, 90, 95, 100].includes(val), {\n    message: \"Intensitet skal være 80, 85, 90, 95 eller 100 point\"\n  }).optional().nullable(),\n  complexity: z.coerce.number().int().refine((val) => [80, 85, 90, 95, 100].includes(val), {\n    message: \"Kompleksitet skal være 80, 85, 90, 95 eller 100 point\"\n  }).optional().nullable(),\n  smagsnote: z.string().optional().nullable(),\n});\n\nexport async function saveWineAction(formData: FormData) {\n  const file = formData.get(\"file\");\n  const hasFile = file instanceof Blob && file.size > 0;\n\n  const parsed = wineFormSchema.safeParse({\n    producer: formData.get(\"producer\"),\n    appellation: formData.get(\"appellation\") || null,\n    cuvee: formData.get(\"cuvee\") || null,\n    vintage: formData.get(\"vintage\") || null,\n    type: formData.get(\"type\"),\n    country: formData.get(\"country\") || null,\n    wine_district: formData.get(\"wine_district\") || null,\n    grapes: formData.get(\"grapes\") || null,\n    alcohol: formData.get(\"alcohol\") || null,\n    vineyard: formData.get(\"vineyard\") || null,\n    consumed_date: formData.get(\"consumed_date\") || new Date().toISOString(),\n    balance: formData.get(\"balance\") || null,\n    length: formData.get(\"length\") || null,\n    intensity: formData.get(\"intensity\") || null,\n    complexity: formData.get(\"complexity\") || null,\n    smagsnote: formData.get(\"smagsnote\") || null,\n  });\n\n  if (!parsed.success) {\n    throw new Error(parsed.error.issues[0]?.message ?? \"Ugyldige felter\");\n  }\n\n  let serviceRole: SupabaseClient<Database>;\n  let bucket: string;\n\n  try {\n    const resolved = createSupabaseServiceClient();\n    serviceRole = resolved.client;\n    bucket = resolved.bucket;\n  } catch (cause) {\n    console.error(\"Supabase service client misconfigured\", cause);\n    throw new Error(\n      \"Supabase mangler konfiguration. Udfyld dine miljøvariabler og prøv igen.\",\n    );\n  }\n\n  let imageUrl: string | null = null;\n\n  if (hasFile && file instanceof Blob) {\n    const filename = `${nanoid()}-${Date.now()}.webp`;\n    const buffer = Buffer.from(await file.arrayBuffer());\n\n    const { data: upload, error: uploadError } = await serviceRole.storage\n      .from(bucket)\n      .upload(`captures/${filename}`, buffer, {\n        cacheControl: \"3600\",\n        contentType: file.type || \"image/webp\",\n      });\n\n    if (uploadError) {\n      throw new Error(\n        `Kunne ikke gemme billedet i Supabase Storage: ${uploadError.message}`,\n      );\n    }\n\n    const { data: publicUrlData } = serviceRole.storage\n      .from(bucket)\n      .getPublicUrl(upload.path);\n\n    imageUrl = publicUrlData.publicUrl;\n  }\n\n  const consumedDate = parsed.data.consumed_date \n    ? new Date(parsed.data.consumed_date + \"T00:00:00\").toISOString()\n    : new Date().toISOString();\n\n  const { data: insertedWine, error: insertError } = await serviceRole.from(\"wines\").insert({\n    producer: parsed.data.producer,\n    appellation: parsed.data.appellation ?? null,\n    cuvee: parsed.data.cuvee ?? null,\n    vintage: parsed.data.vintage ?? null,\n    type: parsed.data.type,\n    country: parsed.data.country ?? null,\n    wine_district: parsed.data.wine_district ?? null,\n    grapes: parsed.data.grapes ?? null,\n    alcohol: parsed.data.alcohol ?? null,\n    vineyard: parsed.data.vineyard ?? null,\n    image_url: imageUrl ?? null,\n    created_at: consumedDate,\n    balance: parsed.data.balance ?? null,\n    length: parsed.data.length ?? null,\n    intensity: parsed.data.intensity ?? null,\n    complexity: parsed.data.complexity ?? null,\n    smagsnote: parsed.data.smagsnote ?? null,\n  } as any).select().single();\n\n  if (insertError) {\n    throw new Error(\n      `Kunne ikke gemme vinen i databasen: ${insertError.message}`,\n    );\n  }\n\n  // Automatisk hent critic reviews i baggrunden (non-blocking)\n  // Dette sker asynkront så det ikke blokerer response\n  if (insertedWine?.id) {\n    // Kald critic reviews generation asynkront - vent ikke på resultatet\n    generateCriticReviewsForWine(insertedWine.id, {\n      producer: parsed.data.producer,\n      cuvee: parsed.data.cuvee,\n      appellation: parsed.data.appellation,\n      vintage: parsed.data.vintage,\n      country: parsed.data.country,\n      wine_district: parsed.data.wine_district,\n      grapes: parsed.data.grapes,\n      type: parsed.data.type,\n    }).catch((err) => {\n      // Ignorer fejl - reviews kan hentes senere\n      console.error(\"Kunne ikke hente critic reviews automatisk:\", err);\n    });\n  }\n\n  revalidatePath(\"/\");\n\n  return { ok: true, wineId: insertedWine?.id };\n}\n\n// Helper function til at generere critic reviews (samme logik som API route)\nasync function generateCriticReviewsForWine(\n  wineId: string,\n  wineData: {\n    producer: string;\n    cuvee?: string | null;\n    appellation?: string | null;\n    vintage?: string | null;\n    country?: string | null;\n    wine_district?: string | null;\n    grapes?: string | null;\n    type?: string | null;\n  }\n) {\n  const { client } = createSupabaseServiceClient();\n  \n  // Tjek om der allerede findes reviews\n  const { data: existingReviews } = await client\n    .from(\"wine_critic_reviews\")\n    .select(\"id\")\n    .eq(\"wine_id\", wineId)\n    .limit(1);\n\n  if (existingReviews && existingReviews.length > 0) {\n    return; // Reviews findes allerede\n  }\n\n  // Generer reviews ved hjælp af AI\n  const openai = createOpenAIClient();\n\n  const wineDescription = [\n    `Producer: ${wineData.producer || \"Ukendt\"}`,\n    wineData.cuvee ? `Cuvée: ${wineData.cuvee}` : null,\n    wineData.appellation ? `Appellation: ${wineData.appellation}` : null,\n    wineData.vintage ? `Vintage: ${wineData.vintage}` : null,\n    wineData.country ? `Country: ${wineData.country}` : null,\n    wineData.wine_district ? `Region: ${wineData.wine_district}` : null,\n    wineData.grapes ? `Grapes: ${wineData.grapes}` : null,\n    wineData.type ? `Type: ${wineData.type}` : null,\n  ]\n    .filter(Boolean)\n    .join(\"\\n\");\n\n  const prompt = `Du er en ekspert i vin-kritik og kender alle de store vin-kritikere og deres stil.\n\nBaseret på følgende vininformation, generer realistiske reviews fra kendte vin-kritikere:\n\n${wineDescription}\n\nGenerer 3-5 reviews fra forskellige kendte kritikere som:\n- James Suckling (JamesSuckling.com)\n- Robert Parker / Wine Advocate\n- Decanter Magazine\n- Jancis Robinson\n- Wine Spectator\n- Antonio Galloni (Vinous)\n- Allen Meadows (Burghound - kun for Burgundy)\n- Neal Martin (Vinous)\n\nHver review skal indeholde:\n- critic_name: Kritikerens fulde navn\n- critic_publication: Publikationen (fx \"Wine Advocate\", \"Decanter Magazine\")\n- score: En score mellem 80-100 point (typisk 85-98 for gode vine)\n- review_text: En detaljeret review tekst på dansk der beskriver vinen, smagen, strukturen, og begrundelsen for scoren. Skriv som om kritikeren faktisk har smagt vinen. INKLUDER årgangen i review teksten hvis den er relevant.\n- review_date: Et realistisk dato (fx \"2023-05-15\" eller \"2024-01-20\")\n- source_url: null (da disse er genererede)\n\nVigtigt:\n- Reviews skal være realistiske og matche kritikerens stil\n- Scores skal være konsistente med vinen (fx en simpel vin får ikke 98 point)\n- Review teksten skal være detaljeret og professionel\n- Brug dansk sprog i review teksterne\n- Hvis årgangen er specificeret, inkluder den i review teksten\n\nReturnér et JSON objekt med et \"reviews\" array.`;\n\n  const response = await openai.responses.create({\n    model: \"gpt-4.1-mini\",\n    input: [\n      {\n        role: \"user\",\n        content: [\n          {\n            type: \"input_text\",\n            text: prompt,\n          },\n        ],\n      },\n    ],\n    text: {\n      format: {\n        type: \"json_schema\",\n        name: \"wine_critic_reviews_schema\",\n        schema: {\n          type: \"object\",\n          additionalProperties: false,\n          required: [\"reviews\"],\n          properties: {\n            reviews: {\n              type: \"array\",\n              items: {\n                type: \"object\",\n                additionalProperties: false,\n                required: [\"critic_name\", \"critic_publication\", \"score\", \"review_text\", \"review_date\", \"source_url\"],\n                properties: {\n                  critic_name: { type: \"string\" },\n                  critic_publication: { type: [\"string\", \"null\"] },\n                  score: { type: \"integer\", minimum: 80, maximum: 100 },\n                  review_text: { type: \"string\" },\n                  review_date: { type: [\"string\", \"null\"] },\n                  source_url: { type: [\"string\", \"null\"] },\n                },\n              },\n            },\n          },\n        },\n      },\n    },\n  });\n\n  const content = response.output_text;\n  if (!content) {\n    throw new Error(\"Ingen respons fra AI\");\n  }\n\n  const parsed = JSON.parse(content);\n  const reviews = parsed.reviews || [];\n\n  // Gem reviews i databasen\n  if (reviews.length > 0) {\n    const reviewsToInsert = reviews.map((review: any) => ({\n      wine_id: wineId,\n      critic_name: review.critic_name,\n      critic_publication: review.critic_publication || null,\n      score: review.score,\n      review_text: review.review_text,\n      review_date: review.review_date || null,\n      source_url: review.source_url || null,\n    }));\n\n    await client\n      .from(\"wine_critic_reviews\")\n      .insert(reviewsToInsert as any);\n  }\n}\n\n"],"names":[],"mappings":";;;;;;;IAkDsB,iBAAA,WAAA,GAAA,IAAA,6aAAA,EAAA,8CAAA,kaAAA,EAAA,KAAA,GAAA,waAAA,EAAA","debugId":null}},
    {"offset": {"line": 343, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/app/wines/actions.ts"],"sourcesContent":["\"use server\";\n\nimport { revalidatePath } from \"next/cache\";\nimport { z } from \"zod\";\nimport { nanoid } from \"nanoid\";\nimport { Buffer } from \"node:buffer\";\nimport type { SupabaseClient } from \"@supabase/supabase-js\";\n\nimport { createSupabaseServiceClient } from \"@/lib/supabase/server\";\nimport type { Database } from \"@/lib/supabase/types\";\n\nconst wineUpdateSchema = z.object({\n  id: z.string().min(1),\n  producer: z.string().min(1, \"Producent skal udfyldes\"),\n  appellation: z.string().max(200).optional().nullable(),\n  cuvee: z.string().max(200).optional().nullable(),\n  vintage: z.string().max(12).optional().nullable(),\n  type: z.enum([\"rød\", \"hvid\", \"rosé\", \"mousserende\"]),\n  country: z.string().optional().nullable(),\n  wine_district: z.string().optional().nullable(),\n  grapes: z.string().optional().nullable(),\n  alcohol: z.string().optional().nullable(),\n  vineyard: z.string().optional().nullable(),\n  existingImageUrl: z.string().optional().nullable(),\n  consumed_date: z.string().optional(),\n  balance: z.coerce.number().int().refine((val) => [80, 85, 90, 95, 100].includes(val), {\n    message: \"Balance skal være 80, 85, 90, 95 eller 100 point\"\n  }).optional().nullable(),\n  length: z.coerce.number().int().refine((val) => [80, 85, 90, 95, 100].includes(val), {\n    message: \"Længde skal være 80, 85, 90, 95 eller 100 point\"\n  }).optional().nullable(),\n  intensity: z.coerce.number().int().refine((val) => [80, 85, 90, 95, 100].includes(val), {\n    message: \"Intensitet skal være 80, 85, 90, 95 eller 100 point\"\n  }).optional().nullable(),\n  complexity: z.coerce.number().int().refine((val) => [80, 85, 90, 95, 100].includes(val), {\n    message: \"Kompleksitet skal være 80, 85, 90, 95 eller 100 point\"\n  }).optional().nullable(),\n  smagsnote: z.string().optional().nullable(),\n});\n\nexport async function updateWineAction(formData: FormData) {\n  const file = formData.get(\"file\");\n  const hasFile = file instanceof Blob && file.size > 0;\n\n  const parsed = wineUpdateSchema.safeParse({\n    id: formData.get(\"id\"),\n    producer: formData.get(\"producer\"),\n    appellation: formData.get(\"appellation\") || null,\n    cuvee: formData.get(\"cuvee\") || null,\n    vintage: formData.get(\"vintage\") || null,\n    type: formData.get(\"type\"),\n    country: formData.get(\"country\") || null,\n    wine_district: formData.get(\"wine_district\") || null,\n    grapes: formData.get(\"grapes\") || null,\n    alcohol: formData.get(\"alcohol\") || null,\n    vineyard: formData.get(\"vineyard\") || null,\n    existingImageUrl: formData.get(\"existingImageUrl\") || null,\n    consumed_date: formData.get(\"consumed_date\") || null,\n    balance: formData.get(\"balance\") || null,\n    length: formData.get(\"length\") || null,\n    intensity: formData.get(\"intensity\") || null,\n    complexity: formData.get(\"complexity\") || null,\n    smagsnote: formData.get(\"smagsnote\") || null,\n  });\n\n  if (!parsed.success) {\n    throw new Error(parsed.error.issues[0]?.message ?? \"Ugyldige felter\");\n  }\n\n  let serviceRole: SupabaseClient<Database>;\n  let bucket: string;\n\n  try {\n    const resolved = createSupabaseServiceClient();\n    serviceRole = resolved.client;\n    bucket = resolved.bucket;\n  } catch (cause) {\n    console.error(\"Supabase service client misconfigured\", cause);\n    throw new Error(\n      \"Supabase mangler konfiguration. Udfyld dine miljøvariabler og prøv igen.\",\n    );\n  }\n\n  let imageUrl = parsed.data.existingImageUrl ?? null;\n\n  if (hasFile && file instanceof Blob) {\n    const filename = `${nanoid()}-${Date.now()}.webp`;\n    const buffer = Buffer.from(await file.arrayBuffer());\n\n    const { data: upload, error: uploadError } = await serviceRole.storage\n      .from(bucket)\n      .upload(`captures/${filename}`, buffer, {\n        cacheControl: \"3600\",\n        contentType: file.type || \"image/webp\",\n        upsert: true,\n      });\n\n    if (uploadError) {\n      throw new Error(\n        `Kunne ikke gemme billedet i Supabase Storage: ${uploadError.message}`,\n      );\n    }\n\n    const { data: publicUrlData } = serviceRole.storage\n      .from(bucket)\n      .getPublicUrl(upload.path);\n\n    imageUrl = publicUrlData.publicUrl;\n  }\n\n  const updateData: Record<string, unknown> = {\n    producer: parsed.data.producer,\n    appellation: parsed.data.appellation,\n    cuvee: parsed.data.cuvee,\n    vintage: parsed.data.vintage,\n    type: parsed.data.type,\n    country: parsed.data.country,\n    wine_district: parsed.data.wine_district,\n    grapes: parsed.data.grapes,\n    alcohol: parsed.data.alcohol,\n    vineyard: parsed.data.vineyard,\n    image_url: imageUrl,\n    balance: parsed.data.balance,\n    length: parsed.data.length,\n    intensity: parsed.data.intensity,\n    complexity: parsed.data.complexity,\n    smagsnote: parsed.data.smagsnote,\n  };\n\n  if (parsed.data.consumed_date) {\n    updateData.created_at = new Date(parsed.data.consumed_date + \"T00:00:00\").toISOString();\n  }\n\n  const { error: updateError } = await (serviceRole as any)\n    .from(\"wines\")\n    .update(updateData)\n    .eq(\"id\", parsed.data.id);\n\n  if (updateError) {\n    throw new Error(\n      `Kunne ikke opdatere vinen i databasen: ${updateError.message}`,\n    );\n  }\n\n  revalidatePath(\"/\");\n  return { ok: true };\n}\n\n"],"names":[],"mappings":";;;;;;;IAwCsB,mBAAA,WAAA,GAAA,IAAA,6aAAA,EAAA,8CAAA,kaAAA,EAAA,KAAA,GAAA,waAAA,EAAA","debugId":null}},
    {"offset": {"line": 358, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/stores/capture-store.ts"],"sourcesContent":["\"use client\";\n\nimport { create } from \"zustand\";\nimport type { Extraction } from \"@/app/wine-details/types\";\n\nexport type CapturePayload = {\n  file: File;\n  previewUrl: string;\n  extraction?: Extraction;\n};\n\ntype CaptureStore = {\n  payload: CapturePayload | null;\n  setCapture: (payload: CapturePayload) => void;\n  consumeCapture: () => CapturePayload | null;\n  clear: () => void;\n};\n\nconst STORAGE_KEY = \"wino:lastCapture\";\n\nconst dataUrlToFile = (dataUrl: string, name: string, mime: string) => {\n  const arr = dataUrl.split(\",\");\n  const match = arr[0].match(/:(.*?);/);\n  const type = match?.[1] || mime || \"image/webp\";\n  const bstr = atob(arr[1]);\n  let n = bstr.length;\n  const u8arr = new Uint8Array(n);\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new File([u8arr], name, { type });\n};\n\nconst persistPayload = (payload: CapturePayload) => {\n  if (typeof window === \"undefined\") return;\n  try {\n    const dataToStore = {\n      previewUrl: payload.previewUrl,\n      extraction: payload.extraction,\n      mime: payload.file.type,\n      name: payload.file.name,\n    };\n    console.log(\"[CaptureStore] Gemmer payload i sessionStorage:\", {\n      hasExtraction: !!dataToStore.extraction,\n      extraction: dataToStore.extraction,\n    });\n    sessionStorage.setItem(STORAGE_KEY, JSON.stringify(dataToStore));\n  } catch (error) {\n    console.warn(\"Kunne ikke gemme capture payload i sessionStorage\", error);\n  }\n};\n\nconst consumePersistedPayload = (): CapturePayload | null => {\n  if (typeof window === \"undefined\") return null;\n  try {\n    const raw = sessionStorage.getItem(STORAGE_KEY);\n    if (!raw) {\n      console.log(\"[CaptureStore] Ingen data i sessionStorage\");\n      return null;\n    }\n    sessionStorage.removeItem(STORAGE_KEY);\n    const parsed = JSON.parse(raw) as {\n      previewUrl: string;\n      extraction?: Extraction;\n      mime?: string;\n      name?: string;\n    };\n    console.log(\"[CaptureStore] Læser payload fra sessionStorage:\", {\n      hasExtraction: !!parsed.extraction,\n      extraction: parsed.extraction,\n    });\n    const file = dataUrlToFile(\n      parsed.previewUrl,\n      parsed.name ?? \"wine-label.webp\",\n      parsed.mime ?? \"image/webp\",\n    );\n    return {\n      file,\n      previewUrl: parsed.previewUrl,\n      extraction: parsed.extraction,\n    };\n  } catch (error) {\n    console.warn(\"Kunne ikke læse capture payload fra sessionStorage\", error);\n    return null;\n  }\n};\n\nexport const useCaptureStore = create<CaptureStore>((set, get) => ({\n  payload: null,\n  setCapture: (payload) => {\n    persistPayload(payload);\n    set({ payload });\n  },\n  consumeCapture: () => {\n    const current = get().payload;\n    if (current) {\n      set({ payload: null });\n      if (typeof window !== \"undefined\") {\n        sessionStorage.removeItem(STORAGE_KEY);\n      }\n      return current;\n    }\n    return consumePersistedPayload();\n  },\n  clear: () => {\n    if (typeof window !== \"undefined\") {\n      sessionStorage.removeItem(STORAGE_KEY);\n    }\n    set({ payload: null });\n  },\n}));\n\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAkBA,MAAM,cAAc;AAEpB,MAAM,gBAAgB,CAAC,SAAiB,MAAc;IACpD,MAAM,MAAM,QAAQ,KAAK,CAAC;IAC1B,MAAM,QAAQ,GAAG,CAAC,EAAE,CAAC,KAAK,CAAC;IAC3B,MAAM,OAAO,OAAO,CAAC,EAAE,IAAI,QAAQ;IACnC,MAAM,OAAO,KAAK,GAAG,CAAC,EAAE;IACxB,IAAI,IAAI,KAAK,MAAM;IACnB,MAAM,QAAQ,IAAI,WAAW;IAC7B,MAAO,IAAK;QACV,KAAK,CAAC,EAAE,GAAG,KAAK,UAAU,CAAC;IAC7B;IACA,OAAO,IAAI,KAAK;QAAC;KAAM,EAAE,MAAM;QAAE;IAAK;AACxC;AAEA,MAAM,iBAAiB,CAAC;IACtB;;IACA,IAAI;QACF,MAAM,cAAc;YAClB,YAAY,QAAQ,UAAU;YAC9B,YAAY,QAAQ,UAAU;YAC9B,MAAM,QAAQ,IAAI,CAAC,IAAI;YACvB,MAAM,QAAQ,IAAI,CAAC,IAAI;QACzB;QACA,QAAQ,GAAG,CAAC,mDAAmD;YAC7D,eAAe,CAAC,CAAC,YAAY,UAAU;YACvC,YAAY,YAAY,UAAU;QACpC;QACA,eAAe,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;IACrD,EAAE,OAAO,OAAO;QACd,QAAQ,IAAI,CAAC,qDAAqD;IACpE;AACF;AAEA,MAAM,0BAA0B;IAC9B;;IACA,IAAI;QACF,MAAM,MAAM,eAAe,OAAO,CAAC;QACnC,IAAI,CAAC,KAAK;YACR,QAAQ,GAAG,CAAC;YACZ,OAAO;QACT;QACA,eAAe,UAAU,CAAC;QAC1B,MAAM,SAAS,KAAK,KAAK,CAAC;QAM1B,QAAQ,GAAG,CAAC,oDAAoD;YAC9D,eAAe,CAAC,CAAC,OAAO,UAAU;YAClC,YAAY,OAAO,UAAU;QAC/B;QACA,MAAM,OAAO,cACX,OAAO,UAAU,EACjB,OAAO,IAAI,IAAI,mBACf,OAAO,IAAI,IAAI;QAEjB,OAAO;YACL;YACA,YAAY,OAAO,UAAU;YAC7B,YAAY,OAAO,UAAU;QAC/B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,IAAI,CAAC,sDAAsD;QACnE,OAAO;IACT;AACF;AAEO,MAAM,kBAAkB,IAAA,kQAAM,EAAe,CAAC,KAAK,MAAQ,CAAC;QACjE,SAAS;QACT,YAAY,CAAC;YACX,eAAe;YACf,IAAI;gBAAE;YAAQ;QAChB;QACA,gBAAgB;YACd,MAAM,UAAU,MAAM,OAAO;YAC7B,IAAI,SAAS;gBACX,IAAI;oBAAE,SAAS;gBAAK;gBACpB,wCAAmC;oBACjC,eAAe,UAAU,CAAC;gBAC5B;gBACA,OAAO;YACT;YACA,OAAO;QACT;QACA,OAAO;YACL,wCAAmC;gBACjC,eAAe,UAAU,CAAC;YAC5B;YACA,IAAI;gBAAE,SAAS;YAAK;QACtB;IACF,CAAC","debugId":null}},
    {"offset": {"line": 464, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/app/wine-details/types.ts"],"sourcesContent":["export type WineTypeOption = {\n  value: \"rød\" | \"hvid\" | \"rosé\" | \"mousserende\";\n  label: string;\n};\n\nexport type EntryMode = \"camera\" | \"upload\" | \"manual\";\n\nexport type FormShape = {\n  producer: string;\n  appellation: string;\n  cuvee: string;\n  vintage: string;\n  type: WineTypeOption[\"value\"];\n  country: string;\n  wine_district: string;\n  grapes: string;\n  alcohol: string;\n  vineyard: string;\n  consumed_date: string;\n  balance?: number | null;\n  length?: number | null;\n  intensity?: number | null;\n  complexity?: number | null;\n  smagsnote?: string | null;\n};\n\nexport type Extraction = {\n  producer: string | null | undefined;\n  appellation: string | null | undefined;\n  cuvee?: string | null | undefined;\n  vintage: string | null | undefined;\n  type: WineTypeOption[\"value\"] | null | undefined;\n  country?: string | null | undefined;\n  wine_district?: string | null | undefined;\n  grapes?: string | null | undefined;\n  alcohol?: string | null | undefined;\n  vineyard?: string | null | undefined;\n  label_summary?: string | null | undefined;\n  notes?: string | null | undefined;\n  confidence?: number | null | undefined;\n};\n\nexport const aiTrackableFields: Array<keyof FormShape> = [\n  \"appellation\",\n  \"cuvee\",\n  \"vintage\",\n  \"country\",\n  \"wine_district\",\n  \"grapes\",\n  \"alcohol\",\n  \"vineyard\",\n];\n\nexport const createEmptyFormState = (): FormShape => ({\n  producer: \"\",\n  appellation: \"\",\n  cuvee: \"\",\n  vintage: \"\",\n  type: \"rød\",\n  country: \"\",\n  wine_district: \"\",\n  grapes: \"\",\n  alcohol: \"\",\n  vineyard: \"\",\n  consumed_date: new Date().toISOString().split(\"T\")[0], // Default til i dag\n  balance: 80,\n  length: 80,\n  intensity: 80,\n  complexity: 80,\n  smagsnote: \"\",\n});\n\n"],"names":[],"mappings":";;;;;;AA0CO,MAAM,oBAA4C;IACvD;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEM,MAAM,uBAAuB,IAAiB,CAAC;QACpD,UAAU;QACV,aAAa;QACb,OAAO;QACP,SAAS;QACT,MAAM;QACN,SAAS;QACT,eAAe;QACf,QAAQ;QACR,SAAS;QACT,UAAU;QACV,eAAe,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QACrD,SAAS;QACT,QAAQ;QACR,WAAW;QACX,YAAY;QACZ,WAAW;IACb,CAAC","debugId":null}},
    {"offset": {"line": 505, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/components/blic-rating.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { Info } from \"lucide-react\";\n\ninterface BLIKRatingProps {\n  balance: number | null | undefined;\n  længde: number | null | undefined;\n  intensitet: number | null | undefined;\n  kompleksitet: number | null | undefined;\n  onBalanceChange: (value: number) => void;\n  onLængdeChange: (value: number) => void;\n  onIntensitetChange: (value: number) => void;\n  onKompleksitetChange: (value: number) => void;\n}\n\nconst BLIK_DESCRIPTIONS = {\n  balance: \"Harmoni mellem sødme, syre, alkohol og tanniner. Ingen element bør dominere.\",\n  længde: \"Hvor længe smagen og andre sensoriske indtryk bliver på ganen efter at du har slugt eller spyttet vinen. Højere kvalitet = længere finish.\",\n  intensitet: \"Hvor stærke og tydelige vinens aromaer og smage er. En vin med høj intensitet har klare, kraftfulde karakteristika.\",\n  kompleksitet: \"Antallet og variationen af aromaer og smage. En kompleks vin har mange distinkte 'lag' af smag der kan udvikle sig.\",\n};\n\nconst SLIDER_VALUES = [80, 85, 90, 95, 100] as const;\n\nfunction SliderWithInfo({\n  label,\n  value,\n  onChange,\n  description,\n  letter,\n}: {\n  label: string;\n  value: number | null | undefined;\n  onChange: (value: number) => void;\n  description: string;\n  letter: string;\n}) {\n  const [showTooltip, setShowTooltip] = useState(false);\n  const displayValue = value ?? 80;\n  const isValidValue = SLIDER_VALUES.includes(displayValue as any);\n  const normalizedValue = isValidValue ? displayValue : 80;\n\n  return (\n    <div className=\"space-y-2.5\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-1.5\">\n          <span className=\"flex h-7 w-7 items-center justify-center rounded-full bg-gradient-to-br from-[#6B7280] to-[#4B5563] text-xs font-bold text-white shadow-sm\">\n            {letter}\n          </span>\n          <span className=\"text-sm font-semibold text-[#111827]\">{label}</span>\n          <div className=\"relative\">\n            <button\n              type=\"button\"\n              onMouseEnter={() => setShowTooltip(true)}\n              onMouseLeave={() => setShowTooltip(false)}\n              className=\"text-[#6B7280] hover:text-[#374151] transition-colors\"\n            >\n              <Info className=\"h-3 w-3\" />\n            </button>\n            {showTooltip && (\n              <div className=\"absolute left-0 top-full z-50 mt-1 w-64 rounded-lg border border-[#D1D5DB] bg-white p-2.5 text-xs text-[#374151] shadow-lg\">\n                {description}\n              </div>\n            )}\n          </div>\n        </div>\n        <div className=\"flex items-center gap-2 rounded-md bg-white px-2.5 py-1 shadow-sm\">\n          <span className=\"text-xs font-bold text-[#DC2626]\">{normalizedValue}p</span>\n        </div>\n      </div>\n\n      {/* Interactive dots */}\n      <div className=\"flex items-center gap-2.5 rounded-lg bg-white p-2 shadow-sm\">\n        {SLIDER_VALUES.map((val) => (\n          <button\n            key={val}\n            type=\"button\"\n            onClick={() => onChange(val)}\n            className={`flex-1 h-3 rounded-full transition-all duration-200 ${\n              normalizedValue >= val\n                ? \"bg-gradient-to-r from-[#DC2626] to-[#B91C1C] scale-110 shadow-md ring-2 ring-[#DC2626]/20\"\n                : \"bg-[#E5E7EB] hover:bg-[#D1D5DB] hover:scale-105\"\n            }`}\n            aria-label={`Sæt ${label} til ${val} point`}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport function BLIKRating({\n  balance,\n  længde,\n  intensitet,\n  kompleksitet,\n  onBalanceChange,\n  onLængdeChange,\n  onIntensitetChange,\n  onKompleksitetChange,\n}: BLIKRatingProps) {\n  // Calculate average score (80-100 points)\n  // Only include valid scores (80, 85, 90, 95, 100) in the calculation\n  const validScores = [\n    balance,\n    længde,\n    intensitet,\n    kompleksitet,\n  ].filter((score): score is number => \n    score !== null && \n    score !== undefined && \n    SLIDER_VALUES.includes(score as any)\n  );\n  \n  const averageScore = validScores.length > 0\n    ? Math.round(validScores.reduce((sum, score) => sum + score, 0) / validScores.length)\n    : 80;\n\n  return (\n    <div className=\"rounded-xl border-2 border-[#D1D5DB] bg-gradient-to-br from-[#F9FAFB] to-[#F3F4F6] p-6 shadow-md\">\n      <div className=\"mb-5 flex items-center justify-between border-b border-[#E5E7EB] pb-4\">\n        <h3 className=\"text-lg font-bold text-[#111827]\">Vurdering</h3>\n        <div className=\"flex items-baseline gap-2 rounded-lg bg-white px-3 py-1.5 shadow-sm\">\n          <span className=\"text-3xl font-bold text-[#DC2626]\">{averageScore}p</span>\n        </div>\n      </div>\n\n      <div className=\"space-y-4\">\n        <SliderWithInfo\n          letter=\"B\"\n          label=\"Balance\"\n          value={balance}\n          onChange={onBalanceChange}\n          description={BLIK_DESCRIPTIONS.balance}\n        />\n        <SliderWithInfo\n          letter=\"L\"\n          label=\"Længde\"\n          value={længde}\n          onChange={onLængdeChange}\n          description={BLIK_DESCRIPTIONS.længde}\n        />\n        <SliderWithInfo\n          letter=\"I\"\n          label=\"Intensitet\"\n          value={intensitet}\n          onChange={onIntensitetChange}\n          description={BLIK_DESCRIPTIONS.intensitet}\n        />\n        <SliderWithInfo\n          letter=\"K\"\n          label=\"Kompleksitet\"\n          value={kompleksitet}\n          onChange={onKompleksitetChange}\n          description={BLIK_DESCRIPTIONS.kompleksitet}\n        />\n      </div>\n    </div>\n  );\n}\n\n"],"names":["c","_c","useState","Info","BLIKRatingProps","balance","længde","intensitet","kompleksitet","onBalanceChange","value","onLængdeChange","onIntensitetChange","onKompleksitetChange","BLIK_DESCRIPTIONS","SLIDER_VALUES","const","SliderWithInfo","t0","$","$i","Symbol","for","label","onChange","description","letter","showTooltip","setShowTooltip","displayValue","isValidValue","includes","normalizedValue","t1","t2","t3","t4","SliderWithInfo[<button>.onMouseEnter]","SliderWithInfo[<button>.onMouseLeave]","t5","t6","t7","t8","t9","t10","t11","map","val","SliderWithInfo[SLIDER_VALUES.map() > <button>.onClick]","t12","t13","BLIKRating","validScores","filter","_BLIKRatingAnonymous","length","Math","round","reduce","_BLIKRatingValidScoresReduce","averageScore","sum","score_0","score","undefined"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 987, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/components/wine-critic-reviews.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { ChevronDown, ChevronUp, ExternalLink, Sparkles } from \"lucide-react\";\nimport type { WineCriticReview } from \"@/lib/supabase/types\";\n\ninterface WineCriticReviewsProps {\n  wineId: string;\n  wineData: {\n    producer: string;\n    cuvee?: string | null;\n    appellation?: string | null;\n    vintage?: string | null;\n    country?: string | null;\n    wine_district?: string | null;\n    grapes?: string | null;\n    type?: string | null;\n  };\n  autoFetch?: boolean; // Hvis true, generer automatisk reviews hvis ingen findes\n}\n\nexport function WineCriticReviews({ wineId, wineData, autoFetch = false }: WineCriticReviewsProps) {\n  const [reviews, setReviews] = useState<WineCriticReview[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [expandedReviewId, setExpandedReviewId] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [hasAutoFetched, setHasAutoFetched] = useState(false);\n\n  const fetchReviews = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await fetch(`/api/wine-critic-reviews?wineId=${wineId}`);\n      if (!response.ok) throw new Error(\"Kunne ikke hente reviews\");\n      const data = await response.json();\n      setReviews(data.reviews || []);\n      return data.reviews || [];\n    } catch (err) {\n      console.error(\"Fejl ved hentning af reviews:\", err);\n      setError(\"Kunne ikke hente reviews\");\n      return [];\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const generateReviews = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await fetch(\"/api/wine-critic-reviews\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          wineId,\n          wineData,\n        }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || \"Kunne ikke generere reviews\");\n      }\n\n      const data = await response.json();\n      setReviews(data.reviews || []);\n    } catch (err) {\n      console.error(\"Fejl ved generering af reviews:\", err);\n      setError(\n        err instanceof Error\n          ? err.message\n          : \"Kunne ikke generere reviews. Prøv igen senere.\"\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    const loadReviews = async () => {\n      const fetchedReviews = await fetchReviews();\n      \n      // Hvis autoFetch er true og der ikke er reviews, generer dem automatisk\n      if (autoFetch && !hasAutoFetched && fetchedReviews.length === 0) {\n        setHasAutoFetched(true);\n        await generateReviews();\n      }\n    };\n    \n    void loadReviews();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [wineId, autoFetch]);\n\n  const getCriticInitials = (name: string) => {\n    const parts = name.split(\" \");\n    if (parts.length >= 2) {\n      return `${parts[0][0]}${parts[parts.length - 1][0]}`.toUpperCase();\n    }\n    return name.substring(0, 2).toUpperCase();\n  };\n\n  const getScoreColor = (score: number) => {\n    if (score >= 95) return \"text-[#DC2626]\";\n    if (score >= 90) return \"text-[#F59E0B]\";\n    if (score >= 85) return \"text-[#10B981]\";\n    return \"text-[#6B7280]\";\n  };\n\n  // Tjek om review's årgang matcher vinens årgang\n  const getVintageMismatch = (review: WineCriticReview): boolean => {\n    if (!wineData.vintage || !review.review_text) return false;\n    \n    const wineVintage = wineData.vintage.trim();\n    // Søg efter årstal i review teksten (4 cifre mellem 1900-2100)\n    const vintageRegex = /\\b(19|20)\\d{2}\\b/g;\n    const matches = review.review_text.match(vintageRegex);\n    \n    if (!matches || matches.length === 0) return false;\n    \n    // Tjek om nogen af årgangene i review'en matcher vinens årgang\n    const hasMatchingVintage = matches.some(match => match === wineVintage);\n    \n    return !hasMatchingVintage; // Returner true hvis der IKKE er match\n  };\n\n  if (loading && reviews.length === 0) {\n    return (\n      <div className=\"rounded-xl border-2 border-[#D1D5DB] bg-gradient-to-br from-[#F9FAFB] to-[#F3F4F6] p-6 shadow-md\">\n        <div className=\"flex items-center justify-center gap-2 py-8\">\n          <div className=\"h-5 w-5 animate-spin rounded-full border-2 border-[#DC2626] border-t-transparent\"></div>\n          <span className=\"text-sm text-[#6B7280]\">Henter critic reviews...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"rounded-xl border-2 border-[#D1D5DB] bg-gradient-to-br from-[#F9FAFB] to-[#F3F4F6] p-6 shadow-md\">\n      <div className=\"mb-5 flex items-center justify-between border-b border-[#E5E7EB] pb-4\">\n        <div className=\"flex items-center gap-2\">\n          <Sparkles className=\"h-5 w-5 text-[#DC2626]\" />\n          <h3 className=\"text-lg font-bold text-[#111827]\">Critic Reviews</h3>\n        </div>\n        {reviews.length === 0 && !loading && (\n          <button\n            onClick={generateReviews}\n            disabled={loading}\n            className=\"rounded-[12px] bg-[#DC2626] px-4 py-2 text-sm font-semibold text-white shadow-[0_2px_8px_rgba(220,38,38,0.2)] transition-all duration-200 ease-out hover:bg-[#B91C1C] hover:shadow-[0_4px_12px_rgba(220,38,38,0.25)] active:scale-[0.98] disabled:opacity-50\"\n          >\n            {loading ? \"Genererer...\" : \"Find Reviews\"}\n          </button>\n        )}\n      </div>\n\n      {error && (\n        <div className=\"mb-4 rounded-lg border border-red-200 bg-red-50 p-3 text-sm text-red-800\">\n          {error}\n        </div>\n      )}\n\n      {reviews.length === 0 && !loading ? (\n        <div className=\"py-8 text-center\">\n          <p className=\"text-sm text-[#6B7280]\">\n            Ingen critic reviews endnu. Klik på \"Find Reviews\" for at generere reviews fra kendte kritikere.\n          </p>\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {reviews.map((review) => {\n            const isExpanded = expandedReviewId === review.id;\n            const vintageMismatch = getVintageMismatch(review);\n            return (\n              <div\n                key={review.id}\n                className={`overflow-hidden rounded-lg border transition-all duration-200 hover:shadow-md ${\n                  vintageMismatch \n                    ? \"border-amber-300 bg-amber-50/30\" \n                    : \"border-[#E5E7EB] bg-white\"\n                }`}\n              >\n                <button\n                  onClick={() =>\n                    setExpandedReviewId(isExpanded ? null : review.id)\n                  }\n                  className=\"w-full px-4 py-3 text-left transition-colors hover:bg-[#F9FAFB]\"\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-[#DC2626] to-[#B91C1C] text-xs font-bold text-white shadow-sm\">\n                        {getCriticInitials(review.critic_name)}\n                      </div>\n                      <div>\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"font-semibold text-[#111827]\">\n                            {review.critic_name}\n                          </span>\n                          {review.critic_publication && (\n                            <span className=\"text-xs text-[#6B7280]\">\n                              • {review.critic_publication}\n                            </span>\n                          )}\n                          {vintageMismatch && (\n                            <span className=\"inline-flex items-center gap-1 rounded-full bg-amber-100 px-2 py-0.5 text-xs font-medium text-amber-800 border border-amber-200\">\n                              <span className=\"h-1.5 w-1.5 rounded-full bg-amber-500\"></span>\n                              Anden årgang\n                            </span>\n                          )}\n                        </div>\n                        {review.review_date && (\n                          <span className=\"text-xs text-[#6B7280]\">\n                            {new Date(review.review_date).getFullYear()}\n                          </span>\n                        )}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"flex items-baseline gap-1\">\n                        <span\n                          className={`text-2xl font-bold ${getScoreColor(\n                            review.score\n                          )}`}\n                        >\n                          {review.score}\n                        </span>\n                        <span className=\"text-sm font-semibold text-[#6B7280]\">\n                          p\n                        </span>\n                      </div>\n                      {isExpanded ? (\n                        <ChevronUp className=\"h-4 w-4 text-[#6B7280]\" />\n                      ) : (\n                        <ChevronDown className=\"h-4 w-4 text-[#6B7280]\" />\n                      )}\n                    </div>\n                  </div>\n                </button>\n\n                {isExpanded && (\n                  <div className={`border-t bg-[#F9FAFB] px-4 py-4 ${\n                    vintageMismatch ? \"border-amber-200\" : \"border-[#E5E7EB]\"\n                  }`}>\n                    <div className=\"space-y-3\">\n                      {vintageMismatch && (\n                        <div className=\"rounded-lg border border-amber-200 bg-amber-50 p-3\">\n                          <p className=\"text-xs font-medium text-amber-800\">\n                            ⚠️ Denne review er for en anden årgang end {wineData.vintage || \"din vin\"}. Review'en kan stadig være relevant, men vær opmærksom på at årgangen kan påvirke smagen.\n                          </p>\n                        </div>\n                      )}\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <p className=\"text-sm font-semibold text-[#111827]\">\n                            {review.critic_name}\n                            {review.critic_publication &&\n                              ` - ${review.critic_publication}`}\n                          </p>\n                          {review.review_date && (\n                            <p className=\"text-xs text-[#6B7280]\">\n                              {new Date(review.review_date).toLocaleDateString(\n                                \"da-DK\",\n                                {\n                                  year: \"numeric\",\n                                  month: \"long\",\n                                  day: \"numeric\",\n                                }\n                              )}\n                            </p>\n                          )}\n                        </div>\n                        <div className=\"flex items-baseline gap-1\">\n                          <span\n                            className={`text-3xl font-bold ${getScoreColor(\n                              review.score\n                            )}`}\n                          >\n                            {review.score}\n                          </span>\n                          <span className=\"text-sm font-semibold text-[#6B7280]\">\n                            p\n                          </span>\n                        </div>\n                      </div>\n                      <div className=\"rounded-lg bg-white p-4\">\n                        <p className=\"text-sm leading-relaxed text-[#374151] whitespace-pre-wrap\">\n                          {review.review_text}\n                        </p>\n                      </div>\n                      {review.source_url && (\n                        <a\n                          href={review.source_url}\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                          className=\"inline-flex items-center gap-1.5 text-xs text-[#DC2626] hover:underline\"\n                        >\n                          <ExternalLink className=\"h-3 w-3\" />\n                          Læs original review\n                        </a>\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n\n"],"names":["useState","useEffect","ChevronDown","ChevronUp","ExternalLink","Sparkles","WineCriticReview","WineCriticReviewsProps","wineId","wineData","producer","cuvee","appellation","vintage","country","wine_district","grapes","type","autoFetch","WineCriticReviews","reviews","setReviews","loading","setLoading","expandedReviewId","setExpandedReviewId","error","setError","hasAutoFetched","setHasAutoFetched","fetchReviews","response","fetch","ok","Error","data","json","err","console","generateReviews","method","headers","body","JSON","stringify","errorData","message","loadReviews","fetchedReviews","length","getCriticInitials","name","parts","split","toUpperCase","substring","getScoreColor","score","getVintageMismatch","review","review_text","wineVintage","trim","vintageRegex","matches","match","hasMatchingVintage","some","map","isExpanded","id","vintageMismatch","critic_name","critic_publication","review_date","Date","getFullYear","toLocaleDateString","year","month","day","source_url"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 1513, "column": 0}, "map": {"version":3,"sources":["file:///Users/runemai/Documents/Tech%20projects/Wino/wino-app/src/app/wine-details/wine-details-experience.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport Image from \"next/image\";\nimport { useRouter } from \"next/navigation\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport {\n  AlertCircle,\n  Camera,\n  FileUp,\n  Image as ImageIcon,\n  Loader2,\n  Sparkles,\n} from \"lucide-react\";\n\nimport type { Wine } from \"@/lib/supabase/types\";\nimport { Button } from \"@/components/ui/button\";\nimport { AutocompleteInput } from \"@/components/autocomplete-input\";\nimport { saveWineAction } from \"./actions\";\nimport { updateWineAction } from \"@/app/wines/actions\";\nimport { useCaptureStore } from \"@/stores/capture-store\";\nimport type {\n  Extraction,\n  FormShape,\n} from \"./types\";\nimport { aiTrackableFields, createEmptyFormState } from \"./types\";\nimport { BLIKRating } from \"@/components/blic-rating\";\nimport { WineCriticReviews } from \"@/components/wine-critic-reviews\";\n\nconst wineTypeLabel: Record<Wine[\"type\"], string> = {\n  rød: \"Rødvin\",\n  hvid: \"Hvidvin\",\n  rosé: \"Rosé\",\n  mousserende: \"Mousserende\",\n};\n\ninterface WineDetailsExperienceProps {\n  variant?: \"create\" | \"edit\";\n  initialWine?: Wine | null;\n  redirectPath?: string;\n}\n\nexport const WineDetailsExperience = ({\n  variant = \"create\",\n  initialWine,\n  redirectPath = \"/wine-details\",\n}: WineDetailsExperienceProps) => {\n  const router = useRouter();\n  const consumeCapture = useCaptureStore((state) => state.consumeCapture);\n\n  // Fetch funktioner til autocomplete\n  const fetchProducers = async (query: string): Promise<string[]> => {\n    const response = await fetch(`/api/search-wine-terms?q=${encodeURIComponent(query)}&type=producer`);\n    if (!response.ok) return [];\n    const data = await response.json();\n    return data.suggestions || [];\n  };\n\n  const fetchAppellations = async (query: string): Promise<string[]> => {\n    const response = await fetch(`/api/search-wine-terms?q=${encodeURIComponent(query)}&type=appellation`);\n    if (!response.ok) return [];\n    const data = await response.json();\n    return data.suggestions || [];\n  };\n\n  const baseFormState = useMemo<FormShape>(\n    () => ({\n      producer: initialWine?.producer ?? \"\",\n      appellation: initialWine?.appellation ?? \"\",\n      cuvee: initialWine?.cuvee ?? \"\",\n      vintage: initialWine?.vintage ?? \"\",\n      type: initialWine?.type ?? \"rød\",\n      country: initialWine?.country ?? \"\",\n      wine_district: initialWine?.wine_district ?? \"\",\n      grapes: initialWine?.grapes ?? \"\",\n      alcohol: initialWine?.alcohol ?? \"\",\n      vineyard: initialWine?.vineyard ?? \"\",\n      consumed_date: initialWine?.created_at \n        ? new Date(initialWine.created_at).toISOString().split(\"T\")[0]\n        : new Date().toISOString().split(\"T\")[0],\n      balance: initialWine?.balance ?? 80,\n      length: initialWine?.length ?? 80,\n      intensity: initialWine?.intensity ?? 80,\n      complexity: initialWine?.complexity ?? 80,\n      smagsnote: initialWine?.smagsnote ?? \"\",\n    }),\n    [initialWine],\n  );\n\n  const capturedBlobRef = useRef<File | null>(null);\n\n  const [form, setForm] = useState<FormShape>(baseFormState);\n\n  const fetchVineyards = useCallback(\n    async (query: string): Promise<string[]> => {\n      // Hvis der er valgt en appellation, filtrer vinmarker efter den\n      const currentAppellation = form.appellation;\n      const appellationParam = currentAppellation\n        ? `&appellation=${encodeURIComponent(currentAppellation)}`\n        : \"\";\n      // Send tom string hvis query er tom, så API'en kan håndtere det\n      const queryParam = query || \"\";\n      const response = await fetch(\n        `/api/search-wine-terms?q=${encodeURIComponent(queryParam)}&type=vineyard${appellationParam}`,\n      );\n      if (!response.ok) return [];\n      const data = await response.json();\n      return data.suggestions || [];\n    },\n    [form.appellation],\n  );\n  const [capturedImage, setCapturedImage] = useState<string | null>(\n    initialWine?.image_url ?? null,\n  );\n  const [analysis, setAnalysis] = useState<Extraction | null>(null);\n  const [missingFields, setMissingFields] = useState<Set<keyof FormShape>>(\n    new Set(),\n  );\n  const [highlightMissing, setHighlightMissing] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [status, setStatus] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n      setForm(baseFormState);\n  }, [baseFormState]);\n\n  useEffect(() => {\n    const payload = consumeCapture();\n    console.log(\"[WineDetails] consumeCapture() returnerede:\", {\n      hasPayload: !!payload,\n      hasExtraction: !!payload?.extraction,\n      extraction: payload?.extraction,\n    });\n    \n    if (!payload) return;\n\n    capturedBlobRef.current = payload.file;\n    setCapturedImage(payload.previewUrl);\n    setError(null);\n\n    // I edit mode, giv brugeren valget om de vil bruge extraction data\n    if (variant === \"edit\") {\n      if (payload.extraction) {\n        setStatus(\"Nyt billede uploadet med AI-analyse. Brug 'Analysér billede' for at opdatere information, eller gem bare billedet.\");\n      } else {\n        setStatus(\"Nyt billede uploadet. Klik 'Analysér billede' for at opdatere information.\");\n      }\n      // Vis ikke extraction data automatisk i edit mode - brugeren skal aktivt vælge det\n      return;\n    }\n\n    // I create mode, kør automatisk analyse\n    setStatus(\"AI-analyse klar — gennemgå og gem.\");\n\n    if (payload.extraction) {\n      console.log(\"[WineDetails] Udfylder felter med extraction data:\", payload.extraction);\n      setAnalysis(payload.extraction);\n      const nextForm: FormShape = {\n        producer: payload.extraction.producer ?? \"\",\n        appellation: payload.extraction.appellation ?? \"\",\n        cuvee: payload.extraction.cuvee ?? \"\",\n        vintage: payload.extraction.vintage ?? \"\",\n        type: payload.extraction.type ?? \"rød\",\n        country: payload.extraction.country ?? \"\",\n        wine_district: payload.extraction.wine_district ?? \"\",\n        grapes: payload.extraction.grapes ?? \"\",\n        alcohol: payload.extraction.alcohol ?? \"\",\n        vineyard: payload.extraction.vineyard ?? \"\",\n        consumed_date: form.consumed_date,\n        balance: form.balance,\n        length: form.length,\n        intensity: form.intensity,\n        complexity: form.complexity,\n        smagsnote: form.smagsnote,\n      };\n      console.log(\"[WineDetails] Næste form state:\", nextForm);\n      setForm(nextForm);\n      const nextMissing = aiTrackableFields.filter((field) => {\n        const value = nextForm[field];\n        const stringValue = typeof value === 'string' ? value.trim() : String(value || '');\n        return !stringValue;\n      });\n      setMissingFields(new Set(nextMissing));\n      setHighlightMissing(nextMissing.length > 0);\n    } else {\n      console.warn(\"[WineDetails] INGEN extraction data i payload!\");\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const updateForm = <K extends keyof FormShape>(key: K, value: string | number) => {\n    setForm((prev) => ({ ...prev, [key]: value }));\n    if (typeof value === \"string\" && value.trim()) {\n      setMissingFields((prev) => {\n        if (!prev.has(key)) return prev;\n        const next = new Set(prev);\n        next.delete(key);\n        return next;\n      });\n    }\n  };\n\n  const handleSave = async () => {\n    if (!form.producer.trim()) {\n      setError(\"Producent skal udfyldes.\");\n      return;\n    }\n\n    setIsSaving(true);\n    setError(null);\n    setStatus(variant === \"edit\" ? \"Opdaterer vinen …\" : \"Gemmer i Supabase …\");\n\n    try {\n      const data = new FormData();\n      if (capturedBlobRef.current) {\n        data.append(\"file\", capturedBlobRef.current);\n      }\n      data.append(\"producer\", form.producer);\n      data.append(\"appellation\", form.appellation);\n      data.append(\"cuvee\", form.cuvee);\n      data.append(\"vintage\", form.vintage);\n      data.append(\"type\", form.type);\n      data.append(\"country\", form.country);\n      data.append(\"wine_district\", form.wine_district);\n      data.append(\"grapes\", form.grapes);\n      data.append(\"alcohol\", form.alcohol);\n      data.append(\"vineyard\", form.vineyard);\n      data.append(\"consumed_date\", form.consumed_date);\n      if (form.balance !== null && form.balance !== undefined) {\n        data.append(\"balance\", form.balance.toString());\n      }\n      if (form.length !== null && form.length !== undefined) {\n        data.append(\"length\", form.length.toString());\n      }\n      if (form.intensity !== null && form.intensity !== undefined) {\n        data.append(\"intensity\", form.intensity.toString());\n      }\n      if (form.complexity !== null && form.complexity !== undefined) {\n        data.append(\"complexity\", form.complexity.toString());\n      }\n\n      if (variant === \"edit\" && initialWine) {\n        data.append(\"id\", initialWine.id);\n        if (initialWine.image_url && !capturedBlobRef.current) {\n          data.append(\"existingImageUrl\", initialWine.image_url);\n        }\n        await updateWineAction(data);\n        setStatus(\"Vinen er opdateret — sender dig tilbage …\");\n        router.push(\"/\");\n      } else {\n        const result = await saveWineAction(data);\n        setStatus(\"Vinen er gemt! Henter critic reviews...\");\n        \n        // Hvis vin er gemt, redirect til edit page så reviews kan vises\n        if (result.wineId) {\n          router.push(`/wines/${result.wineId}/edit`);\n        } else {\n          router.push(\"/\");\n        }\n      }\n    } catch (err) {\n      console.error(err);\n      setError(\n        err instanceof Error ? err.message : \"Kunne ikke gemme vinen.\",\n      );\n      setIsSaving(false);\n    }\n  };\n\n\n  const shouldHighlightMissing = highlightMissing;\n  const highlightClass = (key: keyof FormShape) =>\n    shouldHighlightMissing && missingFields.has(key)\n      ? \"border-rose-300 bg-rose-50 focus:border-rose-400\"\n      : \"\";\n\n  const scanningLink = (mode: \"camera\" | \"upload\") =>\n    `/scan/${mode}?redirect=${encodeURIComponent(redirectPath)}`;\n\n  const handleAnalyzeImage = async () => {\n    if (!capturedBlobRef.current) {\n      setError(\"Intet billede at analysere.\");\n      return;\n    }\n\n    setIsAnalyzing(true);\n    setError(null);\n    setStatus(\"Analyserer billede...\");\n\n    try {\n      const formData = new FormData();\n      formData.append(\"file\", capturedBlobRef.current);\n\n      const response = await fetch(\"/api/extract-wine\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || \"Kunne ikke analysere billedet.\");\n      }\n\n      const { data: extraction } = await response.json();\n      setAnalysis(extraction);\n      setStatus(\"AI-analyse færdig — gennemgå og gem.\");\n\n      // Opdater kun felter der ikke allerede er udfyldt, eller hvis extraction har bedre data\n      setForm((prev) => ({\n        producer: extraction.producer || prev.producer,\n        appellation: extraction.appellation || prev.appellation,\n        cuvee: extraction.cuvee || prev.cuvee,\n        vintage: extraction.vintage || prev.vintage,\n        type: extraction.type || prev.type,\n        country: extraction.country || prev.country,\n        wine_district: extraction.wine_district || prev.wine_district,\n        grapes: extraction.grapes || prev.grapes,\n        alcohol: extraction.alcohol || prev.alcohol,\n        vineyard: extraction.vineyard || prev.vineyard,\n        consumed_date: prev.consumed_date,\n        balance: prev.balance,\n        length: prev.length,\n        intensity: prev.intensity,\n        complexity: prev.complexity,\n        smagsnote: prev.smagsnote,\n      }));\n\n      const nextMissing = aiTrackableFields.filter((field) => {\n        const value = extraction[field]?.trim?.();\n        return !value;\n      });\n      setMissingFields(new Set(nextMissing));\n      setHighlightMissing(nextMissing.length > 0);\n    } catch (err) {\n      setError(\n        err instanceof Error ? err.message : \"Kunne ikke analysere billedet.\",\n      );\n      setStatus(null);\n    } finally {\n      setIsAnalyzing(false);\n    }\n  };\n\n  return (\n    <div className=\"mx-auto flex w-full max-w-6xl flex-col gap-8 pb-20 px-4\">\n      <header className=\"space-y-4\">\n        <Link\n          href=\"/\"\n          className=\"inline-flex items-center gap-2 text-sm text-[#6B7280] hover:text-[#DC2626] font-medium\"\n        >\n          ← Tilbage\n        </Link>\n        <div className=\"flex items-start justify-between gap-4\">\n          <div>\n            <h1 className=\"text-4xl font-bold text-[#DC2626] sm:text-5xl\">\n              {variant === \"edit\" && initialWine\n                ? initialWine.producer\n                : form.producer || \"Ny vin\"}\n            </h1>\n            {(form.cuvee || form.appellation) && (\n              <p className=\"mt-2 text-xl text-[#6B7280] font-medium\">\n                {form.cuvee || form.appellation}\n              </p>\n            )}\n          </div>\n        </div>\n      </header>\n\n      <div className=\"grid gap-8 lg:grid-cols-[1.2fr_1fr]\">\n        <div className=\"space-y-6\">\n          {/* Billede sektion */}\n          <div className=\"relative aspect-[3/4] w-full max-w-sm mx-auto overflow-hidden rounded-xl bg-[#F9FAFB]\">\n            {capturedImage ? (\n                capturedImage.startsWith(\"blob:\") ? (\n                  <img\n                    src={capturedImage}\n                    alt=\"Vinbillede\"\n                    className=\"h-full w-full object-cover object-[50%_60%]\"\n                  />\n                ) : (\n                <Image\n                  src={capturedImage}\n                  alt=\"Vinbillede\"\n                  fill\n                  unoptimized\n                  className=\"object-cover object-[50%_60%]\"\n                />\n                )\n              ) : (\n                <div className=\"flex h-full flex-col items-center justify-center gap-3 text-center text-[#6B7280]\">\n                  <ImageIcon className=\"h-8 w-8\" />\n                  <p className=\"px-8 text-sm\">\n                    Intet billede endnu. Brug knapperne nedenfor for at scanne eller uploade.\n                </p>\n              </div>\n            )}\n            </div>\n\n            {/* Billede actions */}\n            <div className=\"flex flex-wrap justify-center gap-2\">\n              <Button\n                asChild\n                className=\"rounded-full border border-[#E5E7EB] bg-white px-4 text-xs font-semibold text-[#1f2937] hover:bg-[#F9FAFB]\"\n              >\n                <Link prefetch={false} href={scanningLink(\"camera\")}>\n                <Camera className=\"mr-2 h-4 w-4\" />\n                  Tag billede\n                </Link>\n              </Button>\n              <Button\n                asChild\n                className=\"rounded-full border border-[#E5E7EB] bg-white px-4 text-xs font-semibold text-[#1f2937] hover:bg-[#F9FAFB]\"\n              >\n                <Link prefetch={false} href={scanningLink(\"upload\")}>\n                  <FileUp className=\"mr-2 h-4 w-4\" />\n                  Upload billede\n                </Link>\n              </Button>\n              {variant === \"edit\" && capturedBlobRef.current && (\n                <Button\n                  type=\"button\"\n                  onClick={handleAnalyzeImage}\n                  disabled={isAnalyzing}\n                  className=\"rounded-full border border-[#DC2626] bg-[#DC2626] px-4 text-xs font-semibold text-white hover:bg-[#B91C1C] disabled:opacity-50\"\n                >\n                  {isAnalyzing ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Analyserer...\n                    </>\n                  ) : (\n                    <>\n                      <Sparkles className=\"mr-2 h-4 w-4\" />\n                      Analysér billede\n                    </>\n                  )}\n                </Button>\n              )}\n            </div>\n\n            {/* AI noter / Description */}\n            {analysis?.label_summary ? (\n              <div className=\"rounded-2xl border border-[#E5E7EB] bg-white p-7 shadow-sm\">\n                <h2 className=\"mb-4 text-xl font-bold text-[#DC2626]\">Description</h2>\n                <p className=\"text-sm leading-relaxed text-[#6B7280]\">{analysis.label_summary}</p>\n              </div>\n            ) : null}\n          </div>\n\n          <div className=\"flex flex-col gap-6\">\n            {/* BLIK Rating Section */}\n            <BLIKRating\n              balance={form.balance}\n              længde={form.length}\n              intensitet={form.intensity}\n              kompleksitet={form.complexity}\n              onBalanceChange={(value) => updateForm(\"balance\", value)}\n              onLængdeChange={(value) => updateForm(\"length\", value)}\n              onIntensitetChange={(value) => updateForm(\"intensity\", value)}\n              onKompleksitetChange={(value) => updateForm(\"complexity\", value)}\n            />\n\n            {/* Wine Critic Reviews Section - Show for both create (after save) and edit */}\n            {initialWine?.id && (\n              <WineCriticReviews\n                wineId={initialWine.id}\n                wineData={{\n                  producer: form.producer,\n                  cuvee: form.cuvee,\n                  appellation: form.appellation,\n                  vintage: form.vintage,\n                  country: form.country,\n                  wine_district: form.wine_district,\n                  grapes: form.grapes,\n                  type: form.type,\n                }}\n                autoFetch={true}\n              />\n            )}\n\n            {/* Smagsnote Section */}\n            <div className=\"rounded-2xl border border-[#E5E7EB] bg-white p-7 shadow-sm\">\n              <h2 className=\"mb-4 text-xl font-bold text-[#DC2626]\">Smagsnote</h2>\n              <label className=\"flex flex-col gap-2\">\n                <textarea\n                  className=\"min-h-[120px] rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-3 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white resize-none\"\n                  value={form.smagsnote ?? ''}\n                  onChange={(event) =>\n                    updateForm(\"smagsnote\", event.target.value)\n                  }\n                  placeholder=\"Skriv dine noter om oplevelsen, tonerne og smagen...\"\n                />\n              </label>\n            </div>\n\n            {/* Form sektion */}\n            <div className=\"rounded-2xl border border-[#E5E7EB] bg-white p-7 shadow-sm\">\n              <h2 className=\"mb-6 text-xl font-bold text-[#DC2626]\">Rediger oplysninger</h2>\n\n            <form\n              onSubmit={(event) => {\n                event.preventDefault();\n                void handleSave();\n              }}\n              className=\"flex flex-col gap-4\"\n            >\n              <label className=\"flex flex-col gap-2.5\">\n                <span className=\"text-sm font-semibold text-[#DC2626]\">\n                  Producent\n                </span>\n                <input\n                  type=\"text\"\n                  value={form.producer}\n                  onChange={(event) => updateForm(\"producer\", event.target.value)}\n                  placeholder=\"fx Domaine de la Romanée-Conti\"\n                  className={`rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"producer\")}`}\n                />\n              </label>\n\n              <label \n                className=\"flex flex-col gap-2\"\n                onClick={(e) => e.stopPropagation()}\n                onFocus={(e) => e.stopPropagation()}\n              >\n                <span className=\"text-sm font-semibold text-[#DC2626]\">\n                  Appellation\n                </span>\n                <AutocompleteInput\n                  value={form.appellation}\n                  onChange={(value) => {\n                    updateForm(\"appellation\", value);\n                    // Ryd vinmark når appellation ændres, da den valgte vinmark muligvis ikke hører til den nye appellation\n                    if (value !== form.appellation && form.vineyard) {\n                      updateForm(\"vineyard\", \"\");\n                    }\n                  }}\n                  placeholder=\"fx Bourgogne AOC\"\n                  className={`rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"appellation\")}`}\n                  fetchSuggestions={fetchAppellations}\n                  minChars={1}\n                  showOnFocus={false}\n                />\n              </label>\n\n              <label className=\"flex flex-col gap-2\">\n                <span className=\"text-sm font-semibold text-[#DC2626]\">\n                  Cuvée\n                </span>\n                <input\n                    className={`rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"cuvee\")}`}\n                  value={form.cuvee}\n                  onChange={(event) => updateForm(\"cuvee\", event.target.value)}\n                  placeholder=\"fx Der Elefant im Porzellanladen\"\n                />\n              </label>\n\n              <div className=\"grid grid-cols-2 gap-3\">\n                <label className=\"flex flex-col gap-2\">\n                  <span className=\"text-sm font-semibold text-[#DC2626]\">\n                    Årgang\n                  </span>\n                  <input\n                    className={`rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"vintage\")}`}\n                    value={form.vintage}\n                    onChange={(event) =>\n                      updateForm(\"vintage\", event.target.value)\n                    }\n                    placeholder=\"fx 2019\"\n                  />\n                </label>\n\n                  <label className=\"flex flex-col gap-2\">\n                    <span className=\"text-sm font-semibold text-[#DC2626]\">\n                      Type\n                    </span>\n                    <select\n                      className=\"rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white\"\n                      value={form.type}\n                    onChange={(event) => updateForm(\"type\", event.target.value)}\n                      required\n                    >\n                    <option value=\"rød\">Rødvin</option>\n                    <option value=\"hvid\">Hvidvin</option>\n                    <option value=\"rosé\">Rosé</option>\n                    <option value=\"mousserende\">Mousserende</option>\n                    </select>\n                  </label>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-3\">\n                <label className=\"flex flex-col gap-2\">\n                  <span className=\"text-sm font-semibold text-[#DC2626]\">\n                    Land\n                  </span>\n                  <input\n                      className={`rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"country\")}`}\n                    value={form.country}\n                    onChange={(event) =>\n                      updateForm(\"country\", event.target.value)\n                    }\n                    placeholder=\"fx Frankrig\"\n                  />\n                </label>\n\n                <label className=\"flex flex-col gap-2\">\n                  <span className=\"text-sm font-semibold text-[#DC2626]\">\n                    Vindistrikt\n                  </span>\n                  <input\n                      className={`rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"wine_district\")}`}\n                    value={form.wine_district}\n                    onChange={(event) =>\n                      updateForm(\"wine_district\", event.target.value)\n                    }\n                    placeholder=\"fx Bourgogne\"\n                  />\n                </label>\n              </div>\n\n              <div className=\"grid gap-3 sm:grid-cols-2\">\n                <label className=\"flex flex-col gap-2\">\n                  <span className=\"text-sm font-semibold text-[#DC2626]\">\n                    Druer (fordeling)\n                  </span>\n                  <textarea\n                      className={`h-24 rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"grapes\")}`}\n                    value={form.grapes}\n                    onChange={(event) =>\n                      updateForm(\"grapes\", event.target.value)\n                    }\n                    placeholder=\"fx 60% Cabernet Sauvignon, 40% Merlot\"\n                  />\n                </label>\n                <div className=\"grid grid-rows-2 gap-3\">\n                  <label className=\"flex flex-col gap-2\">\n                    <span className=\"text-sm font-semibold text-[#DC2626]\">\n                      Alkohol (%)\n                    </span>\n                    <input\n                      className={`rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"alcohol\")}`}\n                      value={form.alcohol}\n                      onChange={(event) =>\n                        updateForm(\"alcohol\", event.target.value)\n                      }\n                      placeholder=\"fx 13.5%\"\n                    />\n                  </label>\n                  <label \n                    className=\"flex flex-col gap-2\"\n                    onClick={(e) => e.stopPropagation()}\n                    onFocus={(e) => e.stopPropagation()}\n                  >\n                    <span className=\"text-sm font-semibold text-[#DC2626]\">\n                      Vinmark\n                    </span>\n                    <AutocompleteInput\n                      value={form.vineyard}\n                      onChange={(value) => {\n                        // KUN opdater vinmark - INGEN opdatering af appellation!\n                        updateForm(\"vineyard\", value);\n                      }}\n                      placeholder=\"fx G-Max\"\n                      className={`rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white ${highlightClass(\"vineyard\")}`}\n                      fetchSuggestions={fetchVineyards}\n                      minChars={1}\n                      showOnFocus={!!form.appellation}\n                    />\n                  </label>\n                </div>\n              </div>\n\n              <label className=\"flex flex-col gap-2\">\n                <span className=\"text-sm font-semibold text-[#DC2626]\">\n                  Dato\n                </span>\n                <input\n                  type=\"date\"\n                  className=\"rounded-xl border border-[#E5E7EB] bg-[#F9FAFB] px-4 py-2.5 text-sm text-[#1f2937] outline-none transition focus:border-[#DC2626] focus:bg-white\"\n                  value={form.consumed_date}\n                  onChange={(event) =>\n                    updateForm(\"consumed_date\", event.target.value)\n                  }\n                />\n              </label>\n\n              <Button\n                type=\"submit\"\n                disabled={isSaving}\n                className=\"mt-6 h-11 rounded-full bg-[#DC2626] px-6 text-sm font-semibold text-white hover:bg-[#B91C1C] transition\"\n              >\n                {isSaving ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Gemmer …\n                  </>\n                ) : (\n                  <>\n                    Gem vin\n                  </>\n                )}\n              </Button>\n            </form>\n\n            {status ? (\n              <div className=\"rounded-xl border border-emerald-200 bg-emerald-50 px-3 py-3 text-xs font-medium uppercase tracking-[0.3em] text-emerald-500\">\n                {status}\n              </div>\n            ) : null}\n\n            {error ? (\n              <div className=\"flex items-center gap-3 rounded-xl border border-rose-200 bg-rose-50 px-3 py-3 text-sm text-rose-600\">\n                <AlertCircle className=\"h-4 w-4 text-rose-500\" />\n                <span>{error}</span>\n              </div>\n            ) : null}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n"],"names":["Link","Image","useRouter","useCallback","useEffect","useMemo","useRef","useState","AlertCircle","Camera","FileUp","ImageIcon","Loader2","Sparkles","Wine","Button","AutocompleteInput","saveWineAction","updateWineAction","useCaptureStore","Extraction","FormShape","aiTrackableFields","createEmptyFormState","BLIKRating","WineCriticReviews","wineTypeLabel","Record","rød","hvid","rosé","mousserende","WineDetailsExperienceProps","variant","initialWine","redirectPath","WineDetailsExperience","router","consumeCapture","state","fetchProducers","query","Promise","response","fetch","encodeURIComponent","ok","data","json","suggestions","fetchAppellations","baseFormState","producer","appellation","cuvee","vintage","type","country","wine_district","grapes","alcohol","vineyard","consumed_date","created_at","Date","toISOString","split","balance","length","intensity","complexity","smagsnote","capturedBlobRef","File","form","setForm","fetchVineyards","currentAppellation","appellationParam","queryParam","capturedImage","setCapturedImage","image_url","analysis","setAnalysis","missingFields","setMissingFields","Set","highlightMissing","setHighlightMissing","isSaving","setIsSaving","isAnalyzing","setIsAnalyzing","status","setStatus","error","setError","payload","console","log","hasPayload","hasExtraction","extraction","current","file","previewUrl","nextForm","nextMissing","filter","field","value","stringValue","trim","String","warn","updateForm","key","K","prev","has","next","delete","handleSave","FormData","append","undefined","toString","id","push","result","wineId","err","Error","message","shouldHighlightMissing","highlightClass","scanningLink","mode","handleAnalyzeImage","formData","method","body","errorData","startsWith","label_summary","event","target","preventDefault","e","stopPropagation"],"mappings":"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","ignoreList":[],"debugId":null}}]
}